<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="keywords" content="hexo,ä¸ªäººåšå®¢,blog" />
  <meta name="description" content="æŸæŸçš„ä¸ªäººåšå®¢" />
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://busuanzi.ibruce.info">
  <link rel="dns-prefetch" href="https://at.alicdn.com">
  
  <link rel="dns-prefetch" href="https://widget.daovoice.io">
  <link rel="dns-prefetch" href="https://widget-static-cdn.daovoice.io">
  <link rel="dns-prefetch" href="https://im.daovoice.io">
  
  
  <link rel="dns-prefetch" href="https://hm.baidu.com/">
  
  
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://api.github.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  
  <link rel="stylesheet" type="text/css" href="/./style/main.css">
	<link rel="shortcut icon" href="/favicon.ico" title="Favicon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
	<title>Darren Yuen</title>
  
  <script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?awwssw1snsnsnn1ndndnndnd99j";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();
  </script>
  
  
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/123456.js","daovoice");daovoice('init',{app_id: "123456"});daovoice('update');
  </script>
  
<meta name="generator" content="Hexo 7.0.0"></head>
<body>
  <canvas id="pattern-placeholder" height="230"></canvas>
<div class="navbar-header">
  <a class="blog-title" href="/">Darren Yuen</a>
  <a class="face-img" href="/">
    <img src="https://tva3.sinaimg.cn/crop.0.0.200.200.180/005Kc3C1jw8f2uep0hhkvj305k05k3yk.jpg">
  </a>
</div>
<main>
  <div class="article-title">
    

    <ul class="article-info">
      <li>
        å‘å¸ƒ
        <time datetime="2024-01-13T14:27:00.184Z" itemprop="datePublished">2024-01-13</time>
      </li>
      <li>
        
    æ›´æ–° <time datetime="2024-01-13T14:27:22.975Z" itemprop="dateUpdated">2024-01-13</time>

      </li>
      <li id="busuanzi_container_page_pv">
        é˜…è¯» <span id="busuanzi_value_page_pv"></span>
      </li>
    </ul>
  </div>
  <div class="container">
    <div class="article">
      <div class="content">
        
        <blockquote>
<p>åœ¨ä¸€æ¬¡éœ€æ±‚ä¸­éœ€è¦å®ç°æ’­æ”¾å¡ç‰‡æ— é™æ»šåŠ¨çš„æ•ˆæœï¼Œç°æœ‰ä»£ç ä½¿ç”¨çš„æ˜¯Viewpager2+Fragmentçš„æ¡†æ¶ï¼Œä½†å®˜æ–¹çš„Viewpager2å¹¶æ²¡æœ‰æä¾›æ— é™æ»‘åŠ¨çš„APIï¼Œæ‰€ä»¥è¿™é‡Œæ‘¸ç´¢äº†ä¸€å¥—æ–¹æ¡ˆè®°å½•å¦‚ä¸‹ã€‚</p>
</blockquote>
<p>åœ¨åŠ¨æ‰‹codingä¹‹å‰åœ¨ç½‘ä¸Šè°ƒç ”äº†ç›¸å…³æ•ˆæœçš„å®ç°æ–¹æ¡ˆï¼Œå¤§è‡´æœ‰ä¸¤ç§æ€è·¯ï¼šä¸€ç§æ˜¯åœ¨<code>FragmentStateAdapter#getItemCount()</code>ä¸­è¿”å›<code>Integer.MAX_VALUE</code>é€šè¿‡ä¸æ–­å¡«å……å†…å®¹ä½¿å¾—æ»‘ä¸åŠ¨å°½å¤´è¾¾åˆ°æ— é™æ»‘åŠ¨çš„æ•ˆæœï¼›å¦ä¸€ç§åˆ™æ˜¯åœ¨åˆ—è¡¨å‰åå„åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå†é…åˆè‡ªåŠ¨åˆ‡æ¢å®ç°æ— é™æ»‘åŠ¨ã€‚éœ€æ±‚å®ç°ä¸­é‡‡ç”¨çš„æ˜¯ç¬¬äºŒç§æ€è·¯ã€‚</p>
<h3 id="æ”¹é€ æ•°æ®æº"><a href="#æ”¹é€ æ•°æ®æº" class="headerlink" title="æ”¹é€ æ•°æ®æº"></a>æ”¹é€ æ•°æ®æº</h3><p>å‰åå„åŠ ä¸€ä¸ªå…ƒç´ çš„å…·ä½“å®ç°ï¼Œæ˜¯åœ¨æ„é€ Adapteræ•°æ®çš„æ—¶å€™åˆ†åˆ«å°†æ•°æ®åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ å’Œç¬¬ä¸€ä¸ªå…ƒç´ æ‹·è´æ·»åŠ è‡³æ•°æ®åˆ—è¡¨çš„å¤´éƒ¨å’Œå°¾éƒ¨ã€‚å³æ•°æ®åˆ—è¡¨çš„å†…å®¹ç”±[A, B, C] å˜ä¸º [C<code>, A, B, C, A</code>]ã€‚</p>
<h3 id="Viewpager2è‡ªåŠ¨åˆ‡æ¢"><a href="#Viewpager2è‡ªåŠ¨åˆ‡æ¢" class="headerlink" title="Viewpager2è‡ªåŠ¨åˆ‡æ¢"></a>Viewpager2è‡ªåŠ¨åˆ‡æ¢</h3><p>æ³¨å†ŒViewpager2é¡µé¢çŠ¶æ€æ”¹å˜çš„ç›‘å¬å™¨ï¼Œåœ¨å›è°ƒä¸­åˆ¤æ–­å¦‚æœå½“å‰å¤„äºç¬¬ä¸€å¼ å¡ç‰‡ï¼ˆå³C&#96;å¤„ï¼‰åˆ™è‡ªåŠ¨åˆ‡æ¢åˆ°å€’æ•°ç¬¬äºŒå¼ å¡ç‰‡ï¼ˆå³Cå¤„ï¼‰ï¼Œå¦‚æœå½“å‰å½“å‰å¤„äºæœ€åä¸€å¼ å¡ç‰‡åˆ™è‡ªåŠ¨åˆ‡æ¢åˆ°ç¬¬äºŒå¼ ï¼Œé€šè¿‡è¿™æ ·ä¸€ç§æ–¹å¼å¯ä»¥è®©ç”¨æˆ·æ— é™æ»‘åŠ¨å¡ç‰‡ã€‚</p>
<p>ç›¸å…³æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// æ”¹é€ æ•°æ®æºï¼ŒåŸæ•°æ®ä¸º[RED, YELLOW, BLUE]</span><br><span class="line">dataList = arrayListOf&lt;Int&gt;(Color.BLUE, Color.RED, Color.YELLOW, Color.BLUE, Color.RED)</span><br><span class="line"></span><br><span class="line">// åœ¨viewpager2çš„é¡µé¢çŠ¶æ€ç›‘å¬å™¨ä¸­å®ç°è‡ªåŠ¨åˆ‡æ¢</span><br><span class="line">viewPager2?.registerOnPageChangeCallback(object : ViewPager2.OnPageChangeCallback() &#123;</span><br><span class="line">    override fun onPageScrolled(</span><br><span class="line">        position: Int,</span><br><span class="line">        positionOffset: Float,</span><br><span class="line">        positionOffsetPixels: Int</span><br><span class="line">    ) &#123;</span><br><span class="line">        super.onPageScrolled(position, positionOffset, positionOffsetPixels)</span><br><span class="line">        </span><br><span class="line">        if (positionOffset != 0f) return</span><br><span class="line">        </span><br><span class="line">        // itemCount &gt; 1è¦æ”¯æŒå¾ªç¯æ»‘åŠ¨</span><br><span class="line">        if (itemCount &gt; 1) &#123;</span><br><span class="line">            if (position == 0) &#123;</span><br><span class="line">                viewPager?.setCurrentItem(itemCount - 2, false)</span><br><span class="line">            &#125; else if (position == itemCount - 1) &#123;</span><br><span class="line">                viewPager?.setCurrentItem(1, false)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<p>è¯¥ç¤ºä¾‹ä»£ç åœ¨Demoä¸­è¿è¡Œæ˜¯èƒ½è¾¾åˆ°é¢„æœŸæ•ˆæœçš„ï¼Œä½†æ˜¯å½“åœ¨ä¸»å·¥ç¨‹ä¸Šå®ç°æ—¶å‘ç°[A, B, C] to [C<code>, A, B, C, A</code>]è¿™ä¸ªå¯¹æ•°æ®æºçš„æ”¹é€ å‡ºç°äº†æ°´åœŸä¸æœï¼ŒåŸå› æ˜¯Adapterä¸­æœ‰ä¸€ä¸ªé€šè¿‡songIDè·å–å½“å‰ç´¢å¼•çš„æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun findPosition(songId: String): Int &#123;</span><br><span class="line">    return dataList.indexOfFirst &#123; it.songId == songId &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³åœ¨ [C<code>, A, B, C, A</code>]ä¸­ï¼Œå½“æƒ³è·å–Cçš„ä½ç½®æ—¶è¿”å›çš„å´æ˜¯C&#96;çš„ç´¢å¼•ã€‚è¿™ä¸ªæ–¹æ³•åœ¨åŸæœ‰ä»£ç ä¸­è¢«å¤šå¤„è°ƒç”¨ï¼Œæ”¹é€ è¿™ä¸ªæ–¹æ³•ä¹Ÿå­˜åœ¨ä¸€å®šé£é™©ï¼Œæœ¬ç€ä¸åŠ¨ç°æœ‰é€»è¾‘çš„åŸåˆ™ï¼Œå”¯æœ‰æ¢ç´¢å…¶ä»–æ–¹æ³•äº†ã€‚</p>
<p>ä¹‹æ‰€ä»¥è¿™ä¸€ç§æ–¹æ¡ˆä¼šå‡ºç°æ°´åœŸä¸æœï¼Œæ˜¯å› ä¸ºæ”¹é€ æ•°æ®æºæ—¶å¯¹æ•°æ®å…ƒç´ è¿›è¡Œäº†æ·±æ‹·è´ï¼Œå¯¼è‡´æ‰§è¡Œ<code>findPostion</code>å¯èƒ½å‡ºé”™ã€‚èƒ½ä¸èƒ½é¿å¼€é€šè¿‡æ·±æ‹·è´çš„æ–¹å¼æ¥é€‚é…å½“å‰çš„<code>findPosition</code>é€»è¾‘å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p>
<h3 id="ä¼˜åŒ–åçš„æ•°æ®æº"><a href="#ä¼˜åŒ–åçš„æ•°æ®æº" class="headerlink" title="ä¼˜åŒ–åçš„æ•°æ®æº"></a>ä¼˜åŒ–åçš„æ•°æ®æº</h3><p>æ—¢ç„¶é€šè¿‡æ·±æ‹·è´å…ƒç´ å¯¹è±¡ä¸å¯è¡Œï¼Œé‚£å¹²è„†ä¸è¿›è¡Œå¯¹è±¡çš„æ‹·è´äº†ã€‚åœ¨æ•°æ®åˆ—è¡¨å‰åå„åŠ ä¸€ä¸ªå…ƒç´ è¿™ä¸ªæ–¹æ¡ˆä¼˜åŒ–åçš„æ•°æ®æºå®ç°æ–¹å¼æ˜¯åœ¨æ•°æ®åˆ—è¡¨å‰åå„åŠ ä¸€ä¸ªå…ƒç´ ç±»å‹çš„ç©ºå¯¹è±¡ï¼Œå³åªåˆ›å»ºå…ƒç´ å¯¹è±¡ï¼Œä¸å¯¹å…¶è¿›è¡Œä½¿ç”¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (list.size &gt; 1) &#123;</span><br><span class="line">    // æ„é€ å¾ªç¯åˆ—è¡¨ [A, B, C] to [obj, A, B, C, obj]</span><br><span class="line">    dataList.add(PlaySongInfo())</span><br><span class="line">    dataList.addAll(list)</span><br><span class="line">    dataList.add(PlaySongInfo())</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    dataList.addAll(list)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±äºæ”¹é€ åçš„æ•°æ®æºæœ‰å‰åå„æœ‰ä¸€ä¸ªä»…ä½œå¡«å……ä½¿ç”¨çš„å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨åˆ—è¡¨æ•°æ®çš„æ—¶å€™éœ€è¦åšä¸€ä¸‹indexçš„è½¬æ¢ï¼Œä»¥ä¸‹æ˜¯ä½¿ç”¨æ•°æ®æºåˆ›å»ºfragmentçš„ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">override fun createFragment(position: Int): Fragment &#123;</span><br><span class="line">    val dataSize = dataList.size</span><br><span class="line">    // å¡ç‰‡å¤§äº1æ—¶æ”¯æŒå¾ªç¯æ»‘åŠ¨</span><br><span class="line">    val realPosition = if (dataSize &gt; 1) &#123;</span><br><span class="line">        if (position == 0) &#123;</span><br><span class="line">            dataSize - 2</span><br><span class="line">        &#125; else if (position == dataSize - 1) &#123;</span><br><span class="line">            1</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            position</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        position</span><br><span class="line">    &#125;</span><br><span class="line">      val songInfo = dataList[realPosition]</span><br><span class="line">      return TargetFragment.newInstance(songInfo)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œä¼˜åŒ–åçš„æ•°æ®æºå†é…åˆä¸ŠViewpager2çŠ¶æ€ç›‘å¬å™¨ä¸­çš„è‡ªåŠ¨åˆ‡æ¢é€»è¾‘ï¼Œæ’­æ”¾å¡ç‰‡æ— é™æ»‘åŠ¨çš„æ•ˆæœå°±å®ç°äº†ã€‚</p>

      </div>
        <div class="support-author">
          <p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚ ğŸ™
          <a href="https://888.com/index.html" target="_blank">å…³äºè½¬è½½è¯·çœ‹è¿™é‡Œ</a>
            <!--<a class="btn-pay"  href="#pay-modal">Â¥ æ‰“èµæ”¯æŒ</a>-->
          </p>
        </div>
        <!--
            <div class="like ">
              <div class="like-button">
                <a id="like-note" href="">
                  <i class="icon-heart"></i>å–œæ¬¢
                </a>
              </div>
              <span id="likes-count">256</span>
            </div>
        -->
        <div class="otherLink">
          <div class="previous">
          </div>
          <div class="next">
          </div>
        </div>
        <div class="comments" id="comments">
          
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  const gitalk = new Gitalk({
    clientID: '8888a8888',
    clientSecret: '8888886666666',
    repo: 'xxxx.github.io',
    owner: 'admin',
    admin: ['admin'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false
  })

  gitalk.render('comments');
</script>


        </div>
      </div>
    </div>
   </div>
</main>
<div class="footer">
  <div class="info">
    <p>
    <a target="_blank" rel="noopener" href="https://hexo.io"> Hexo </a> å¼ºåŠ›é©±åŠ¨ |
      <a target="_blank" rel="noopener" href="https://github.com/Youthink/hexo-themes-yearn"> Yearn </a>
      ä¸»é¢˜
    </p>
    <p>&copy;2013-2018 æŸæŸçš„åšå®¢ äº¬ICPå¤‡xxxxxxå·</p>
  </div>
</div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>//console
  var consoleConfig = '\næ¬¢è¿è®¿é—® https://hufangyun.com ï¼Œå›´è§‚å°çŒ¿å¤§åœ£çš„åšå®¢(ã¥ï½¡â—•â€¿â€¿â—•ï½¡)ã¥ï¼\n,\næœ¬åšå®¢ä½¿ç”¨ %cHexo%c æ­å»ºï¼Œåšå®¢ä¸»é¢˜ä¸ºå°çŒ¿å¤§åœ£å¼€å‘çš„ %chexo-themes-yearn%c ~~~ ğŸ‰ğŸ‰ğŸ‰ \n\næºç  https://github.com/Youthink/hexo-themes-yearn \n\nå¦‚æœå–œæ¬¢å¯ä»¥ star æ”¯æŒä¸€ä¸‹ â¤ï¸~\n,\næ‰«æä¸‹é¢çš„äºŒç»´ç ï¼Œåœ¨æ‰‹æœºä¸ŠæŸ¥çœ‹åšå®¢ï¼\n,https://static.hufangyun.com/blog-url-qrcode-180-180.png,\n æƒ³çŸ¥é“è¿™ä¸ªæ•ˆæœå¦‚ä½•å®ç°çš„ï¼Ÿåšå®¢å†…æœç´¢ console å½©è›‹ ğŸš€ ï¼\n'.split(',');
  var canConsole = true;
  var consoleInfo = (function(consoleConfig) {
  if (!canConsole || !consoleConfig || consoleConfig.length < 1) {
    return;
  }
  var consoleColor = '#6190e8';
  var _console;
  var backgroundTextStyle = 'padding: 1px 5px;color: #fff;background: ' + consoleColor + ';'
  var textStyle = 'color: ' + consoleColor + ';';

  consoleConfig.map(o => {
    var num = (o.match(/%c/g) || []).length;
    if(/^http(s)?:\/\//.test(o)) {
      console.log('%c     ', 'background: url(' + o + ') no-repeat left center;font-size: 180px;');
      return;
    }
    if (num > 0) {
      var logArguments = [];
      for (var i = 0; i < num; i++) {
        if (i % 2 === 0) {
          logArguments.push(backgroundTextStyle);
        } else {
          logArguments.push(textStyle);
        }
      }
      (_console = console).log.apply(_console, ['%c' + o, textStyle].concat(logArguments));
      return;
    }
    console.log('%c' + o, textStyle);
  });
}(consoleConfig));</script><script type="text/javascript" src="/./js/main.js"></script>

  <script src="//at.alicdn.com/t/font_159214_mvtxvg9me9.js"></script>
</body>
</html>
